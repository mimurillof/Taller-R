"0","# Buscar nombres relacionados con on-base y slugging en el dataset (distintas convenciones posibles)"
"0","pattern_new <- ""on.?base|slug|ops|on_base|onbase|onbaseplus|onbase_plus|onbaseplusslug|obs"""
"0","new_vars_found <- names(mlb11)[grepl(pattern_new, names(mlb11), ignore.case = TRUE)]"
"0","if(length(new_vars_found) == 0){"
"0","  # fallback a nombres comunes usados en el lab"
"0","  fallback <- c(""new_obs"", ""new_slug"", ""new_onbase"")"
"0","  new_vars <- intersect(fallback, names(mlb11))"
"0","} else {"
"0","  new_vars <- new_vars_found"
"0","}"
"0",""
"0","if(length(new_vars) == 0){"
"0","  message(""No se encontraron variables 'nuevas' relacionadas con on-base/slugging en 'mlb11'."")"
"0","  data.frame(variable = character(0), r_squared = numeric(0))"
"0","} else {"
"0","  r2_new <- sapply(new_vars, function(v){"
"0","    f <- as.formula(paste(""runs ~"", v))"
"0","    summary(lm(f, data = mlb11))$r.squared"
"0","  })"
"0","  data.frame(variable = new_vars, r_squared = as.numeric(r2_new))[order(-r2_new), ]"
"0","}"
