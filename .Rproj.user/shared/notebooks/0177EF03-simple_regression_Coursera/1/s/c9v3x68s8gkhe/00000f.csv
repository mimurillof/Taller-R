"0","# Detectar variables disponibles en el dataset para evitar errores por nombres inexistentes"
"0","candidate_vars <- c("
"0","  ""at_bats"", ""hits"", ""homeruns"","
"0","  # posibles nombres para batting average"
"0","  ""batting_avg"", ""batting.avg"", ""avg"", ""battingAverage"","
"0","  ""strikeouts"", ""stolen_bases"", ""wins"""
"0",")"
"0","vars <- intersect(candidate_vars, names(mlb11))"
"0","if(!""at_bats"" %in% names(mlb11)) message(""Nota: 'at_bats' no estÃ¡ presente en el dataset; usando las variables encontradas: "", paste(vars, collapse="", ""))"
"0","if(length(vars) == 0) stop(""No se encontraron variables predictoras candidatas en 'mlb11'. Revisa los nombres de columnas."")"
"0",""
"0","r2s <- sapply(vars, function(v){"
"0","  f <- as.formula(paste(""runs ~"", v))"
"0","  summary(lm(f, data = mlb11))$r.squared"
"0","})"
"0","r2_tbl <- data.frame(variable = vars, r_squared = as.numeric(r2s), row.names = NULL)"
"0","r2_tbl <- r2_tbl[order(-r2_tbl$r_squared), ]"
"0","r2_tbl"
