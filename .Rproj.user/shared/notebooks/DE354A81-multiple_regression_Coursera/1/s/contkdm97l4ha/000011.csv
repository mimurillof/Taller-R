"0",""
"0","# Término con mayor p-valor"
"0","drop_term <- term_pvals_df$term[which.max(term_pvals_df$max_p)]"
"0","cat(""Dropping term with largest p-value:"", drop_term, ""(p="", round(max(term_pvals_df$max_p), 4), "")\n"")"
"1","Dropping term with largest p-value:"
"1"," "
"1","cls_profs"
"1"," "
"1","(p="
"1"," "
"1","0.7781"
"1"," "
"1",")
"
"0","# Reajustar modelo sin ese término"
"0","m_reduced <- update(m_full, paste0("". ~ . - "", drop_term))"
"0","summary(m_reduced)"
"1","
Call:
"
"1",""
"1","lm(formula = score ~ rank + ethnicity + gender + language + age + 
    cls_perc_eval + cls_students + cls_level + cls_credits + 
    bty_avg + pic_outfit + pic_color, data = evals)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-1.7836 "
"1","-0.3257 "
"1"," 0.0859 "
"1"," 0.3513 "
"1"," 0.9551 "
"1","
"
"1","
Coefficients:
"
"1","                     "
"1","   Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)          "
"1","  4.0872523"
"1","  0.2888562"
"1","  14.150"
"1","  < 2e-16"
"1"," ***"
"1","
ranktenure track     "
"1"," -0.1476746"
"1","  0.0819824"
"1","  -1.801"
"1"," 0.072327"
"1"," .  "
"1","
ranktenured          "
"1"," -0.0973829"
"1","  0.0662614"
"1","  -1.470"
"1"," 0.142349"
"1","    "
"1","
ethnicitynot minority"
"1","  0.1274458"
"1","  0.0772887"
"1","   1.649"
"1"," 0.099856"
"1"," .  "
"1","
gendermale           "
"1","  0.2101231"
"1","  0.0516873"
"1","   4.065"
"1"," 5.66e-05"
"1"," ***"
"1","
languagenon-english  "
"1"," -0.2282894"
"1","  0.1111305"
"1","  -2.054"
"1"," 0.040530"
"1"," *  "
"1","
age                  "
"1"," -0.0089992"
"1","  0.0031326"
"1","  -2.873"
"1"," 0.004262"
"1"," ** "
"1","
cls_perc_eval        "
"1","  0.0052888"
"1","  0.0015317"
"1","   3.453"
"1"," 0.000607"
"1"," ***"
"1","
cls_students         "
"1","  0.0004687"
"1","  0.0003737"
"1","   1.254"
"1"," 0.210384"
"1","    "
"1","
cls_levelupper       "
"1","  0.0606374"
"1","  0.0575010"
"1","   1.055"
"1"," 0.292200"
"1","    "
"1","
cls_creditsone credit"
"1","  0.5061196"
"1","  0.1149163"
"1","   4.404"
"1"," 1.33e-05"
"1"," ***"
"1","
bty_avg              "
"1","  0.0398629"
"1","  0.0174780"
"1","   2.281"
"1"," 0.023032"
"1"," *  "
"1","
pic_outfitnot formal "
"1"," -0.1083227"
"1","  0.0721711"
"1","  -1.501"
"1"," 0.134080"
"1","    "
"1","
pic_colorcolor       "
"1"," -0.2190527"
"1","  0.0711469"
"1","  -3.079"
"1"," 0.002205"
"1"," ** "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.4974"
"1"," "
"1","on"
"1"," "
"1","449"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.187"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.1634"
"1"," "
"1","
F-statistic:"
"1"," "
"1","7.943"
"1"," "
"1","on"
"1"," "
"1","13"
"1"," "
"1","and"
"1"," "
"1","449"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","2.336e-14"
"1","
"
"1","
"
"0","# Comparar coeficientes entre modelos (forma segura)"
"0","coefs_full <- coef(summary(m_full))"
"0","coefs_red <- coef(summary(m_reduced))"
"0","all_coef_names <- union(rownames(coefs_full), rownames(coefs_red))"
"0",""
"0","estimate_full <- rep(NA, length(all_coef_names))"
"0","p_full <- rep(NA, length(all_coef_names))"
"0","estimate_reduced <- rep(NA, length(all_coef_names))"
"0","p_reduced <- rep(NA, length(all_coef_names))"
"0",""
"0","idx_full <- match(all_coef_names, rownames(coefs_full))"
"0","idx_red <- match(all_coef_names, rownames(coefs_red))"
"0","has_full <- !is.na(idx_full)"
"0","has_red <- !is.na(idx_red)"
"0","if(any(has_full)){"
"0","  estimate_full[has_full] <- coefs_full[idx_full[has_full], 1]"
"0","  p_full[has_full] <- coefs_full[idx_full[has_full], 4]"
"0","}"
"0","if(any(has_red)){"
"0","  estimate_reduced[has_red] <- coefs_red[idx_red[has_red], 1]"
"0","  p_reduced[has_red] <- coefs_red[idx_red[has_red], 4]"
"0","}"
"0",""
"0","comp <- data.frame("
"0","  term = all_coef_names,"
"0","  estimate_full = estimate_full,"
"0","  p_full = p_full,"
"0","  estimate_reduced = estimate_reduced,"
"0","  p_reduced = p_reduced,"
"0","  row.names = NULL,"
"0","  stringsAsFactors = FALSE"
"0",")"
"0",""
"0","head(comp, n = 20)"
