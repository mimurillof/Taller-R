"0","## Identificar término con mayor p-valor (considerando todas las filas asociadas al término)"
"0","coef_tbl <- summary(m_full)$coefficients"
"0","term_labels <- attr(terms(m_full), ""term.labels"")"
"0","term_pvals <- sapply(term_labels, function(t){"
"0","  # filas cuyos nombres comienzan por el término (maneja factores con múltiples niveles)"
"0","  rows <- grepl(paste0('^', t), rownames(coef_tbl))"
"0","  if(!any(rows)) return(NA)"
"0","  max(coef_tbl[rows, 4], na.rm = TRUE)"
"0","})"
"0","term_pvals_df <- data.frame(term = term_labels, max_p = term_pvals, row.names = NULL)"
"0","term_pvals_df[order(-term_pvals_df$max_p), ]"
